<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <title>SCDMS - 수요 분석 (GiftElf)</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="css/gift_elf.css"/>

  <script src="/js/auth.js"></script>
  <script>const currentUser=requireRole(["GiftElf"]);</script>
</head>

<body data-page="demand">
  <header class="app-header navbar navbar-dark px-3">
    <div class="d-flex align-items-center gap-2">
      <span class="logo-icon">🎁</span>
      <span class="navbar-brand h1 mb-0">SCDMS</span>
    </div>

    <h1 class="h5 mb-0 text-white position-absolute start-50 translate-middle-x">
      GiftElf - 수요 분석
    </h1>

    <div class="d-flex align-items-center gap-3">
      <div class="text-end lh-1">
        <div id="header-user-name" class="text-white small fw-bold mb-1">사용자</div>
        <span id="header-user-role" class="badge bg-success rounded-pill" style="font-size:.7rem;">Role</span>
      </div>
      <button id="btn-logout" class="btn btn-outline-light btn-sm">로그아웃</button>
    </div>
  </header>

  <main class="container my-4">

    <!-- 탭 네비게이션 -->
    <ul class="nav nav-pills mb-3 tab-bar">
      <li class="nav-item"><a class="nav-link" href="gift_elf_materials.html">재료 채굴</a></li>
      <li class="nav-item"><a class="nav-link" href="gift_elf_production.html">선물 제작</a></li>
      <li class="nav-item"><a class="nav-link active" href="gift_elf_demand.html">수요 분석</a></li>
    </ul>

    <h2 class="h6 mb-3">수요 분석 대시보드</h2>

    <!-- 요약 카드 영역 -->
    <div class="row g-3 mb-4">
      
      <div class="col-md-4">
        <div class="card summary-card bg-soft-green h-100">
          <div class="card-body">
            <span class="summary-label">총 수요</span>
            <div class="summary-value-lg">
              <span id="summary-demand-count">0</span>
              <span class="unit-text">개</span>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card summary-card bg-soft-yellow h-100">
          <div class="card-body">
            <span class="summary-label">재고 보유</span>
            <div class="summary-value-lg">
              <span id="summary-stock-count">0</span>
              <span class="unit-text">개</span>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card summary-card bg-soft-red h-100">
          <div class="card-body">
            <span class="summary-label">부족량</span>
            <div class="summary-value-lg">
              <span id="summary-shortage-count">0</span>
              <span class="unit-text">개</span>
            </div>
          </div>
        </div>
      </div>
      
    </div>

    <!-- 상세 테이블 (로그 테이블 디자인 적용) -->
    <div class="card p-4">
      <h3 class="h6 mb-3">선물별 수급 현황</h3>
      
      <div class="table-responsive log-table-scroll-container custom-scrollbar">
        <table class="table table-hover align-middle custom-table" id="demand-table">
          <thead class="table-green-header sticky-top">
            <tr>
              <th style="width: 20%">선물 이름</th>
              <th style="width: 15%">요청</th>
              <th style="width: 15%">재고</th>
              <th style="width: 15%">부족량</th>
              <th style="width: 15%">충족률</th>
              <th style="width: 20%">진행률</th>
            </tr>
          </thead>
          <tbody>
            <!-- JS 렌더링 -->
          </tbody>
        </table>
      </div>
    </div>

    <div class="alert alert-warning mt-3 small d-flex align-items-center gap-2">
      <span>⚠</span>
      <span>부족한 선물은 '선물 제작' 탭에서 추가 생산이 필요합니다.</span>
    </div>

  </main>

  <div id="toast" class="toast-custom d-none"></div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/gift_elf_demand.js"></script>
</body>
</html>