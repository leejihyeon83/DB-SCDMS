<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ListElf - 아이 목록</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="css/list_elf.css">

    <script src="/js/auth.js"></script>
    <script src="js/list_elf.js"></script>
</head>

<body>
<nav class="navbar navbar-expand-lg navbar-dark scdms-navbar">
    <div class="container-fluid px-4">
        <a class="navbar-brand d-flex align-items-center" href="#">
            <span class="brand-icon">🎄</span>
            <span>SCDMS · 명단 관리 사이트</span>
        </a>
        
        <div class="d-flex align-items-center gap-3">
            <div class="text-end lh-1">
                <div id="header-user-name" class="text-white fw-bold small mb-1">
                    사용자
                </div>
                <span id="header-user-role" class="badge bg-light text-dark rounded-pill" style="font-size: 0.7rem;">
                    ListElf
                </span>
            </div>
            <button type="button" class="btn btn-outline-light btn-sm" id="btn-logout">
                로그아웃
            </button>
        </div>
    </div>
</nav>

<div class="scdms-tabs">
    <div class="container px-4">
        <ul class="nav py-3">
            <li class="nav-item">
                <a class="nav-link active" href="/list_elf.html">아이 목록</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/add_child.html">아이 등록</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/rules.html">규칙 관리</a>
            </li>
        </ul>
    </div>
</div>

<div class="container px-4 py-4">
    <div class="scdms-card p-4 p-md-5">

        <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-md-between mb-4">
            <div>
                <h2 class="fw-bold mb-1">아이 목록</h2>
                <p class="text-muted mb-0">노스폴 시스템에 등록된 모든 아이들을 확인하고 관리해요.</p>
            </div>
            <div class="mt-3 mt-md-0">
                <a href="/add_child.html" class="btn btn-main">
                    + 새 아이 등록
                </a>
            </div>
        </div>

        <div class="row g-2 mb-4">
            <div class="col-md-6">
                <input id="searchInput" class="form-control" placeholder="이름 또는 주소 검색…" />
            </div>
            <div class="col-md-3">
                <select id="regionFilter" class="form-select" onchange="renderChildren()">
                    <option value="">전체 지역</option>
                </select>
            </div>
            <div class="col-md-3">
                <button class="btn btn-outline-secondary w-100" onclick="loadChildren()">검색 / 새로고침</button>
            </div>
        </div>

        <div class="row g-3 mb-4">
            <div class="col-md-4">
                <div class="summary-card summary-nice">
                    <span class="label">착한 아이들</span>
                    <span class="value" id="countNice">0</span>
                </div>
            </div>
            <div class="col-md-4">
                <div class="summary-card summary-naughty">
                    <span class="label">나쁜 아이들</span>
                    <span class="value" id="countNaughty">0</span>
                </div>
            </div>
            <div class="col-md-4">
                <div class="summary-card summary-pending">
                    <span class="label">심사 대기 중</span>
                    <span class="value" id="countPending">0</span>
                </div>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="table-secondary">
                    <tr>
                        <th>ID</th>
                        <th>이름</th>
                        <th>주소</th>
                        <th>지역</th>
                        <th>상태</th>
                        <th>배송 상태</th>
                        <th>Wishlist</th>
                        <th>설명</th>
                        <th>작업</th>
                    </tr>
                </thead>
                <tbody id="childTableBody"></tbody>
            </table>
        </div>

    </div>
</div>

<div class="modal fade" id="wishlistModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title">Wishlist 상세보기</h5>
                <button class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">
                <table class="table table-bordered">
                    <thead class="table-light">
                        <tr>
                            <th>우선순위</th>
                            <th>Gift ID</th>
                            <th>선물 이름</th>
                        </tr>
                    </thead>
                    <tbody id="wishlistTableBody"></tbody>
                </table>
            </div>

        </div>
    </div>
</div>

<div class="modal fade" id="noteModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title">아이 설명 수정</h5>
                <button class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">
                <textarea id="noteInput" class="form-control" rows="6"></textarea>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                <button class="btn btn-main" onclick="saveNote()">저장</button>
            </div>

        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="./js/ex.js"></script>
<script src="list_elf.js"></script>

</body>
</html>